{% extends "base.html" %}
{% block body_class %}page-map{% endblock %}
{% block page_title %}Map{% endblock %}

{% block topbar %}{% endblock %}

{% block content %}
<div style="display:flex;flex-direction:column;height:100vh;width:100%;">
    <div style="display:flex;align-items:center;justify-content:space-between;padding:0 16px;height:44px;background:var(--bg-secondary);border-bottom:1px solid var(--border);flex-shrink:0;">
        <span id="map-aircraft" style="font-size:13px;color:var(--text-secondary);">Loading map...</span>
        <a href="/tar1090/" target="_blank" class="btn btn-sm">Open Full Screen</a>
    </div>
    <iframe src="/tar1090/" style="flex:1;width:100%;border:none;display:block;"></iframe>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
async function updateMapInfo() {
    try {
        const r = await fetch('/api/aircraft');
        const d = await r.json();
        document.getElementById('map-aircraft').textContent =
            (d.total || 0) + ' aircraft tracked (' + (d.with_position || 0) + ' with position)';
    } catch(e) {}
}
updateMapInfo();
setInterval(updateMapInfo, 15000);
</script>
{% endblock %}
